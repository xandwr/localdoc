# Localdoc

A fast, local CLI tool for querying and inspecting docpack documentation files generated by the Doctown builder.

## Features

- **Inspect docpack metadata** - View project info, generation stats, and language summary
- **List all symbols** - See every function, struct, enum, trait, etc. in the codebase
- **Symbol lookup** - Get detailed documentation for specific symbols
- **Full-text search** - Search across all documentation summaries and descriptions
- **File filtering** - List files and filter symbols by source file
- **Colorized output** - Easy-to-read, syntax-highlighted terminal output
- **Fast & offline** - No network required, instant results from local docpacks

## Installation

```bash
cd localdoc
cargo build --release
```

The binary will be available at `target/release/localdoc`.

## Usage

### Inspect Docpack Metadata

View top-level information about a docpack:

```bash
localdoc inspect <path-to-docpack>
```

Example:
```bash
localdoc inspect ./doctown-builder-docs.docpack
```

Output includes:
- Format version
- Project name, version, repo, and commit
- Generation timestamp
- Language breakdown
- Symbol and documentation counts

### Query Commands

All query operations follow this pattern:
```bash
localdoc query <path-to-docpack> <subcommand>
```

#### List All Symbols

```bash
localdoc query <docpack> symbols
```

Lists all symbols with their kind (function, struct, enum, etc.), ID, file, and line number.

#### Look Up a Specific Symbol

```bash
localdoc query <docpack> symbol <name>
```

Returns the full documentation for a symbol, including:
- Symbol ID, kind, location, and signature
- Summary and detailed description
- Parameters (with types and descriptions)
- Return type and value
- Usage examples
- Additional notes

Example:
```bash
localdoc query ./builder-docs.docpack symbol "from_env"
```

#### Search Documentation

```bash
localdoc query <docpack> search <keyword>
```

Performs full-text search across symbol names, signatures, summaries, and descriptions.

Example:
```bash
localdoc query ./builder-docs.docpack search "Config"
```

#### List Source Files

```bash
localdoc query <docpack> files
```

Shows all source files referenced in the docpack with symbol counts.

#### Filter Symbols by File

```bash
localdoc query <docpack> file <filename>
```

Shows all symbols defined in files matching the given name.

Example:
```bash
localdoc query ./builder-docs.docpack file "config.rs"
```

## Docpack Format

Localdoc reads `.docpack` files, which are ZIP archives containing:

- `manifest.json` - Project metadata and generation info
- `symbols.json` - Array of all extracted symbols
- `docs/*.json` - Individual documentation files for each symbol

See the [DOCPACK_FORMAT.md](../builder/DOCPACK_FORMAT.md) specification for details.

## Example Workflow

```bash
# 1. Generate a docpack using the builder
cd ../builder
cargo run -- https://github.com/user/repo

# 2. Inspect the generated docpack
cd ../localdoc
./target/release/localdoc inspect ../builder/repo-docs.docpack

# 3. Explore the codebase
./target/release/localdoc query ../builder/repo-docs.docpack files
./target/release/localdoc query ../builder/repo-docs.docpack symbols
./target/release/localdoc query ../builder/repo-docs.docpack search "error handling"

# 4. Look up specific symbols
./target/release/localdoc query ../builder/repo-docs.docpack symbol "main"
```

## Architecture

- **models.rs** - Serde data structures for manifest, symbols, and documentation
- **docpack.rs** - ZIP archive reader and query engine
- **main.rs** - CLI interface using clap with colored output

## License

Same as the parent Doctown project.
